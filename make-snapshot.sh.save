#!/usr/bin/env bash

OUTPUT="expatise-snapshot.md"

# Clear the output file
: > "$OUTPUT"

# Get all tracked files under app/ and components/
git ls-files 'app/*' 'components/*' | \
  grep -E '\.(tsx|ts|js|jsx|css)$' | \
  sort | while read -r file; do

  echo "### $file" >> "$OUTPUT"

  ext="${file##*.}"
  case "$ext" in
    ts|tsx|js|jsx) lang="tsx" ;;
    css)           lang="css" ;;
    *)             lang="" ;;
  esac

  if [ -n "$lang" ]; then
    echo "\`\`\`$lang" >> "$OUTPUT"
  else
    echo "\`\`\`" >> "$OUTPUT"
  fi

  cat "$file" >> "$OUTPUT"
  echo -e "\n\`\`\`\n" >> "$OUTPUT"
done

echo "âœ… Snapshot written to $OUTPUT"

